# boardview

## Описание модуля

* **doc** - папка с описанием модуля.
* **boardview** - папка с модулем.
    * **boardview.py** - файл с основным виджетом **BoardView** для рисования платы.
    * **descriptionitem.py** - файл с классом **DescriptionItem** для отрисовки названия или идеального рисунка элемента платы.
    * **elementitem.py** - файл с классом **ElementItem** для элемента платы.
    * **utils.py** - файл с полезными функциями.
    * **viewmode.py** - файл с перечислением режимов **ViewMode**, в которых может находиться сцена.
* **examples** - папка с примерами.
* **tests** - тесты.

## Классы

В **boardview** есть следующие классы:

- **BoardView** - класс виджета для рисования платы;
- **ElementItem** - класс для элемента платы;
- **DescriptionItem** - класс для отрисовки названия или идеального рисунка элемента платы.

#### Класс **ElementItem**

В классе **ElementItem** используются:

- **RectComponent** из модуля **PyQtExtendedScene** для отрисовки границ элемента;
- **PointComponent** из модуля **PyQtExtendedScene** для отрисовки пинов элемента;
- **DescriptionItem**.

У элементов **ElementItem** можно включить/выключить отрисовку названия элемента с помощью метода:

```python
element_item.show_element_description(True/False)
```

Если для элемента имеется svg изображение, то его можно добавить с помощью метода:

```python
element_item.set_element_description(svg_file, rotation)
```

- **svg_file** - путь до svg изображения;
- **rotation** - сколько раз нужно повернуть изображение против часовой стрелки на 90°.

## Режимы

Виджет **BoardView** может находиться в одном из режимов:

* **NORMAL** - обычный режим;
* **EDIT** - режим редактирования.

#### Общий функционал для всех режимов

Во всех режимах можно:

- Перетаскивать сцену зажатой **ЛЕВОЙ** кнопкой мышки.
- Зумировать сцену колесиком мышки.
- Выделять элемент кликом **ЛЕВОЙ** кнопки мышки.
- Выделять несколько элементов кликом **ЛЕВОЙ** кнопки мышки с зажатой клавишей **Ctrl**.
- Копировать выделанные элементы с помощью быстрых клавиш **Ctrl + C**.
- Вырезать выделенные элементы с помощью быстрых клавиш **Ctrl + X**.
- Вставлять скопированные/вырезанные элементы с помощью быстрых клавиш **Ctrl + V**.
- Удалять выделенные элементы с помощью клавиши **Delete**.

#### Обычный режим

По умолчанию виджет находится в обычном режиме. Для перехода в обычный режим нужно вызвать метод:

```python
view.set_view_mode(ViewMode.NORMAL)
```

В обычном режиме можно:

- Выделять элементы движением мышки с зажатой **ПРАВОЙ** кнопкой мышки.
- Включить отрисовку названий элементов с помощью вызова метода:

  ```python
  view.show_element_descriptions()
  ```

- Отключить отрисовку названий элементов с помощью вызова метода:

  ```python
  view.hide_element_descriptions()
  ```

#### Режим редактирования

Режим редактирования предназначен для редактирования элемента платы. Для перехода в режим редактирования нужно выделить элемент и вызвать метод:

```python
view.set_view_mode(ViewMode.EDIT)
```

Если при переходе в этот режим не был выделен элемент либо были выделены несколько элементов, то будет создан новый (пустой) элемент.

В режиме редактирования можно:

- Рисовать точку из контекстного меню и кликом **ПРАВОЙ** кнопки мышки с нажатой клавишей **Shift**. **ВАЖНО**: точку можно нарисовать только в пределах границ элемента.
- Рисовать прямоугольник зажатой **ПРАВОЙ** кнопкой мышки. **ВАЖНО**: прямоугольник представляет собой новую границу элемента. У элемента может быть только одна граница. Если новый прямоугольник не включает в себя все уже существующие точки элемента, то такой прямоугольник будет удален.
- Перетаскивать точку, прямоугольник зажатой **ЛЕВОЙ** кнопкой мышки при наведении мышки внутрь соответствующего компонента.
- Изменять размеры прямоугольника. Для этого нужно навести мышку на границу прямоугольника и зажать **ЛЕВУЮ** кнопку мышки.

## Раскрашивание элементов и пинов

Элементы платы можно раскрасить, как автоматически распознанные, и как созданные вручную:

- раскрасить элемент, как автоматический:

  ```python
  view.color_element_item_as_auto(element_number)
  ```

- раскрасить элемент, как созданный вручную:

  ```python
  view.color_element_item_as_manual(element_number)
  ```

Пины можно раскрасить с помощью методов:

- раскрасить пин, в котором нет опорной и тестовой сигнатур <span style="color:#FF00FF">(RGB = 255;0;255)</span>:

  ```python
  view.color_pin_as_empty(element_number, pin_number)
  ```

- раскрасить пин, в котором есть только опорная сигнатура, непохожая на разрыв <span style="color:#FFA500">(RGB = 255;165;0)</span>:

  ```python
  view.color_pin_as_loss(element_number, pin_number)
  ```

- раскрасить пин, в котором тестовая сигнатура совпадает с опорной <span style="color:#00FF00">(RGB = 0;255;0)</span>:

  ```python
  view.color_pin_as_matching(element_number, pin_number)
  ```

- раскрасить пин, в котором тестовая сигнатура не совпадает с опорной <span style="color:#FF0000">(RGB = 255;0;0)</span>:

  ```python
  view.color_pin_as_nonmatching(element_number, pin_number)
  ```

- раскрасить пин, в котором есть только опорная сигнатура <span style="color:#0000FF">(RGB = 0;0;255)</span>:

  ```python
  view.color_pin_with_reference_signature_only(element_number, pin_number)
  ```
